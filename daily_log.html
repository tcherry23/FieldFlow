<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
  <title>Daily Pressure Log</title>
  <style>
    body {
      font-family: Arial, sans-serif;
      background: #f5f5f5;
      margin: 0;
      padding: 20px;
    }
    h1, h2 {
      text-align: center;
    }
    .field-selector {
      text-align: center;
      margin-bottom: 20px;
    }
    .well-form {
      background: white;
      border-radius: 8px;
      padding: 15px;
      margin-bottom: 15px;
      box-shadow: 0 2px 4px rgba(0,0,0,0.1);
    }
    .well-form.green { border-left: 5px solid green; }
    .well-form.yellow { border-left: 5px solid orange; }
    .well-form.red { border-left: 5px solid red; }
    label {
      display: block;
      margin: 5px 0 2px;
    }
    input[type="text"], input[type="number"] {
      width: 95%;
      padding: 6px;
      margin-bottom: 10px;
    }
    button, select {
      padding: 8px 12px;
      font-size: 16px;
      margin-top: 10px;
    }
    .footer-buttons {
      text-align: center;
      margin-top: 30px;
    }
    .summary {
      text-align: center;
      margin-bottom: 15px;
      font-size: 18px;
      font-weight: bold;
    }
  </style>
</head>
<body>

  <h1>Daily Pressure Log</h1>

  <div class="field-selector">
    <label for="fieldDropdown"><strong>Select Field:</strong></label>
    <select id="fieldDropdown" onchange="renderWells()">
      <option value="Dixon">Dixon</option>
      <option value="Simpson Chapel">Simpson Chapel</option>
      <option value="Mineral City">Mineral City</option>
    </select>
  </div>

  <div class="summary">
    Daily MCF Target: <input type="number" id="mcfTarget" placeholder="Enter MCF Goal" onchange="calculateTotals()" />
    <div>Running Total: <span id="runningTotal">0</span> MCF/hr</div>
  </div>

  <div id="wellsContainer"></div>

  <div class="footer-buttons">
    <button onclick="window.location.href='index.html'">üè† Home</button>
  </div>

  <script>
    const wellsByField = {
      "Dixon": ["Dixon 1", "Dixon 2", "Dixon 3", "Dixon 4", "Dixon 5"],
      "Simpson Chapel": [],
      "Mineral City": []
    };

    const orificeSizes = {
      "Dixon 1": 1,
      "Dixon 2": 1,
      "Dixon 3": 1,
      "Dixon 4": 1,
      "Dixon 5": 1
    };

    function renderWells() {
      const field = document.getElementById('fieldDropdown').value;
      const wells = wellsByField[field];
      const container = document.getElementById('wellsContainer');
      container.innerHTML = '';

      if (wells.length === 0) {
        container.innerHTML = '<p style="text-align:center;">Coming Soon</p>';
        return;
      }

      wells.forEach(well => {
        const orifice = orificeSizes[well] || 1;
        const now = new Date().toISOString().slice(0, 16);
        const form = document.createElement('div');
        form.className = 'well-form';
        form.innerHTML = `
          <h2>${well}</h2>
          <label>Date/Time:</label>
          <input type="text" value="${now}" readonly />
          <label>Orifice Size (in):</label>
          <input type="text" value="${orifice}" readonly />
          <label>Upstream Pressure (psi):</label>
          <input type="number" class="upstream" oninput="calculateWell(this)" />
          <label>Downstream Pressure (psi):</label>
          <input type="number" class="downstream" oninput="calculateWell(this)" />
          <label>Differential Pressure (ŒîP):</label>
          <input type="text" class="diff" readonly />
          <label>MCF/hour:</label>
          <input type="text" class="mcf" readonly />
          <label>Notes:</label>
          <input type="text" />
        `;
        container.appendChild(form);
      });
    }

    function calculateWell(input) {
      const form = input.closest('.well-form');
      const up = parseFloat(form.querySelector('.upstream').value) || 0;
      const down = parseFloat(form.querySelector('.downstream').value) || 0;
      const deltaP = up - down;
      const orifice = parseFloat(form.querySelector('input[value="1"]').value) || 1;
      const C = 24.19; // Example constant
      const mcf = deltaP > 0 ? (C * Math.sqrt(deltaP)).toFixed(2) : 0;

      form.querySelector('.diff').value = deltaP.toFixed(2);
      form.querySelector('.mcf').value = mcf;

      form.classList.remove('green', 'yellow', 'red');
      const target = parseFloat(document.getElementById('mcfTarget').value);
      if (!isNaN(target)) {
        const ratio = mcf / target;
        if (ratio >= 0.9) form.classList.add('green');
        else if (ratio >= 0.6) form.classList.add('yellow');
        else form.classList.add('red');
      }

      calculateTotals();
    }

    function calculateTotals() {
      const allMCF = document.querySelectorAll('.mcf');
      let total = 0;
      allMCF.forEach(input => {
        total += parseFloat(input.value) || 0;
      });
      document.getElementById('runningTotal').textContent = total.toFixed(2);
    }

    renderWells();
  </script>
</body>
</html>
